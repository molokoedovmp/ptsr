const { PrismaClient } = require('@prisma/client')

const prisma = new PrismaClient()

async function main() {
  // ИНСТРУКЦИЯ: Замените эти значения на нужные
  const COURSE_SLUG = 'osnovy-samopomoshchi-pri-ptsr' // slug курса
  const MODULE_ORDER = 0 // номер модуля (начинается с 0)

  console.log('Добавляем уроки к модулю...')

  // Находим курс
  const course = await prisma.course.findUnique({
    where: { slug: COURSE_SLUG },
    include: {
      modules: {
        orderBy: { orderIndex: 'asc' },
      },
    },
  })

  if (!course) {
    console.error('Курс не найден')
    return
  }

  const module = course.modules[MODULE_ORDER]
  if (!module) {
    console.error('Модуль не найден')
    return
  }

  console.log(`Добавляем уроки в модуль: "${module.title}"`)

  // Список уроков для добавления
  const lessons = [
    {
      title: 'Введение: Что такое ПТСР',
      description: 'Базовое понимание посттравматического стрессового расстройства',
      content: `## Что такое ПТСР?

Посттравматическое стрессовое расстройство (ПТСР) — это психическое состояние, которое может развиться после переживания или наблюдения травматического события.

### Основные симптомы:

1. **Навязчивые воспоминания**
   - Флешбэки
   - Кошмары
   - Дистресс при напоминаниях

2. **Избегание**
   - Уход от людей и мест
   - Избегание мыслей о травме

3. **Негативные изменения**
   - Изменения в мышлении
   - Изменения в настроении

4. **Гиперактивность**
   - Повышенная бдительность
   - Проблемы со сном
   - Раздражительность

### Важно помнить:
- ПТСР - это нормальная реакция на ненормальное событие
- Восстановление возможно
- Профессиональная помощь эффективна`,
      videoUrl: null,
      duration: 15,
      isFree: true,
      orderIndex: 0,
    },
    {
      title: 'Как ПТСР влияет на мозг',
      description: 'Понимание нейробиологии травмы',
      content: `## Нейробиология ПТСР

Травма влияет на несколько ключевых областей мозга:

### Миндалевидное тело (Амигдала)
- Отвечает за реакцию "бей или беги"
- При ПТСР становится гиперактивным
- Приводит к повышенной тревожности

### Гиппокамп
- Отвечает за память и контекст
- Может уменьшиться в размере
- Влияет на обработку воспоминаний

### Префронтальная кора
- Регулирует эмоции и рациональное мышление
- При ПТСР может быть менее активной
- Затрудняет контроль над реакциями

### Хорошие новости:
Мозг пластичен! С помощью терапии и практики эти изменения можно обратить.`,
      videoUrl: null,
      duration: 20,
      isFree: false,
      orderIndex: 1,
    },
    {
      title: 'Распознавание триггеров',
      description: 'Учимся определять и работать с триггерами',
      content: `## Что такое триггеры?

Триггеры — это любые стимулы, которые напоминают о травматическом событии и вызывают сильную эмоциональную реакцию.

### Типы триггеров:

**Сенсорные**
- Звуки
- Запахи
- Визуальные образы
- Тактильные ощущения

**Эмоциональные**
- Определенные чувства
- Напряжение в отношениях

**Ситуационные**
- Определенные места
- Годовщины
- Похожие ситуации

### Дневник триггеров

Ведите записи:
1. Что произошло?
2. Что вы почувствовали?
3. Какая была реакция?
4. Что помогло справиться?

### Техники работы с триггерами:
- Заземление
- Осознанное дыхание
- Называние эмоций
- План безопасности`,
      videoUrl: null,
      duration: 25,
      isFree: false,
      orderIndex: 2,
    },
    {
      title: 'Создание плана безопасности',
      description: 'Разработка персонального плана действий при кризисе',
      content: `## План безопасности при ПТСР

### Шаг 1: Определите предупреждающие знаки
- Изменения в настроении
- Физические симптомы
- Изменения в поведении

### Шаг 2: Стратегии самопомощи
1. Техники заземления
2. Дыхательные упражнения
3. Физическая активность
4. Творческие занятия

### Шаг 3: Социальная поддержка
Люди, которым я могу позвонить:
- Имя: ___________
- Телефон: ___________

### Шаг 4: Профессиональная помощь
- Терапевт: ___________
- Горячая линия кризисной помощи: 8-800-2000-122
- Скорая психиатрическая помощь: 103

### Шаг 5: Сделайте окружение безопасным
- Уберите потенциально опасные предметы
- Создайте безопасное пространство
- Подготовьте список успокаивающих действий

Распечатайте этот план и держите его под рукой!`,
      videoUrl: null,
      duration: 30,
      isFree: false,
      orderIndex: 3,
    },
  ]

  // Создаём уроки
  for (const lessonData of lessons) {
    const lesson = await prisma.lesson.create({
      data: {
        ...lessonData,
        moduleId: module.id,
      },
    })
    console.log(`✓ Создан урок: "${lesson.title}"`)
  }

  console.log(`\nГотово! Добавлено ${lessons.length} уроков в модуль "${module.title}"`)
}

main()
  .catch((e) => {
    console.error(e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })

